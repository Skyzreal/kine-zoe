import{N as u,S as v,Tb as h,c as a}from"./chunk-72BHGUR2.js";var g="basil",b=function(e){return e===3?"v3":e},w="https://js.stripe.com",I="".concat(w,"/").concat(g,"/stripe.js"),x=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,T=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/,y="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",U=function(e){return x.test(e)||T.test(e)},_=function(){for(var e=document.querySelectorAll('script[src^="'.concat(w,'"]')),r=0;r<e.length;r++){var n=e[r];if(U(n.src))return n}return null},E=function(e){var r=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(I).concat(r);var i=document.head||document.body;if(!i)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return i.appendChild(n),n},A=function(e,r){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"7.7.0",startTime:r})},s=null,p=null,d=null,C=function(e){return function(r){e(new Error("Failed to load Stripe.js",{cause:r}))}},B=function(e,r){return function(){window.Stripe?e(window.Stripe):r(new Error("Stripe.js not available"))}},F=function(e){return s!==null?s:(s=new Promise(function(r,n){if(typeof window>"u"||typeof document>"u"){r(null);return}if(window.Stripe&&e&&console.warn(y),window.Stripe){r(window.Stripe);return}try{var i=_();if(i&&e)console.warn(y);else if(!i)i=E(e);else if(i&&d!==null&&p!==null){var o;i.removeEventListener("load",d),i.removeEventListener("error",p),(o=i.parentNode)===null||o===void 0||o.removeChild(i),i=E(e)}d=B(r,n),p=C(n),i.addEventListener("load",d),i.addEventListener("error",p)}catch(l){n(l);return}}),s.catch(function(r){return s=null,Promise.reject(r)}))},V=function(e,r,n){if(e===null)return null;var i=r[0],o=i.match(/^pk_test/),l=b(e.version),f=g;o&&l!==f&&console.warn("Stripe.js@".concat(l," was loaded on the page, but @stripe/stripe-js@").concat("7.7.0"," expected Stripe.js@").concat(f,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var S=e.apply(void 0,r);return A(S,n),S},c,P=!1,R=function(){return c||(c=F(null).catch(function(e){return c=null,Promise.reject(e)}),c)};Promise.resolve().then(function(){return R()}).catch(function(t){P||console.warn(t)});var j=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];P=!0;var i=Date.now();return R().then(function(o){return V(o,r,i)})};var m=class t{STRIPE_PUBLISHABLE_KEY="pk_test_51RnR4cFg8bVJVRSPrhgdSbnlsy2lz0mowntP1fB5HfjCP4Ce5yUEQaRnFxzdjQ9FO90CtEYeu8myZZ8xPSryJp5E00AbRotQ3n";API_BASE_URL="https://kine-zoe-api.vercel.app";get stripePublishableKey(){return this.STRIPE_PUBLISHABLE_KEY}get apiBaseUrl(){return this.API_BASE_URL}static \u0275fac=function(r){return new(r||t)};static \u0275prov=u({token:t,factory:t.\u0275fac,providedIn:"root"})};var L=class t{http=v(h);envService=v(m);stripe=null;initializeStripe(){return a(this,null,function*(){return this.stripe||(this.stripe=yield j(this.envService.stripePublishableKey,{locale:"auto"})),this.stripe})}createPaymentSession(e){return a(this,null,function*(){let r=yield this.http.post(`${this.envService.apiBaseUrl}/api/create-payment-session`,{clientInfo:e,amount:e.amount||1e4,currency:"cad",service:e.service,timeSlot:e.timeSlot,timeSlotEnd:e.timeSlotEnd}).toPromise();if(!r)throw new Error("Failed to create payment session");return r})}redirectToCheckout(e){return a(this,null,function*(){let r=yield this.initializeStripe();if(!r)throw new Error("Stripe failed to initialize");let{error:n}=yield r.redirectToCheckout({sessionId:e});if(n)throw n})}verifyPayment(e){return a(this,null,function*(){let r=yield this.http.get(`${this.envService.apiBaseUrl}/api/verify-payment/${e}`).toPromise();if(!r)throw new Error("Failed to verify payment");return r})}static \u0275fac=function(r){return new(r||t)};static \u0275prov=u({token:t,factory:t.\u0275fac,providedIn:"root"})};export{L as a};
